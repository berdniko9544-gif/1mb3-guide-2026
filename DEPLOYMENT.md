# üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

## –í–∞—Ä–∏–∞–Ω—Ç 1: Vercel (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –¥–ª—è Next.js –ø—Ä–æ–µ–∫—Ç–æ–≤.

### –®–∞–≥–∏:

1. **–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ Vercel**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://vercel.com
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ GitHub/GitLab/Bitbucket

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   ```bash
   # –ï—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   git init
   git add .
   git commit -m "Initial commit"
   
   # –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥:
   git remote add origin https://github.com/–≤–∞—à-username/–≤–∞—à-repo.git
   git push -u origin main
   ```

3. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Vercel**
   - –ù–∞–∂–º–∏—Ç–µ "Add New Project"
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç Next.js
   - –ù–∞–∂–º–∏—Ç–µ "Deploy"

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
   - –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí Environment Variables
   - –î–æ–±–∞–≤—å—Ç–µ `NEXT_PUBLIC_SITE_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.vercel.app`

5. **–ì–æ—Ç–æ–≤–æ!** 
   - –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.vercel.app`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–ø–ª–æ–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ main

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –¥–æ–º–µ–Ω–∞:
- Settings ‚Üí Domains ‚Üí Add Domain
- –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DNS

---

## –í–∞—Ä–∏–∞–Ω—Ç 2: Netlify

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Vercel —Å –ø–æ—Ö–æ–∂–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.

### –®–∞–≥–∏:

1. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ Netlify**
   - https://netlify.com

2. **–°–æ–∑–¥–∞–π—Ç–µ `netlify.toml` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:**
   ```toml
   [build]
     command = "npm run build"
     publish = ".next"

   [[plugins]]
     package = "@netlify/plugin-nextjs"
   ```

3. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   - Add new site ‚Üí Import from Git
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - Build command: `npm run build`
   - Publish directory: `.next`

4. **Deploy**

---

## –í–∞—Ä–∏–∞–Ω—Ç 3: VPS (–†–æ—Å—Å–∏–π—Å–∫–∏–µ —Ö–æ—Å—Ç–∏–Ω–≥–∏)

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ —Ä–∞–±–æ—Ç—ã –≤ –†–§.

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:
- Timeweb
- Beget
- Reg.ru
- FirstVDS

### –®–∞–≥–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH:**
   ```bash
   ssh root@–≤–∞—à-ip
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js:**
   ```bash
   curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
   sudo apt-get install -y nodejs
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PM2 (–º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤):**
   ```bash
   npm install -g pm2
   ```

4. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç:**
   ```bash
   cd /var/www
   git clone https://github.com/–≤–∞—à-username/–≤–∞—à-repo.git
   cd –≤–∞—à-repo
   ```

5. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ:**
   ```bash
   npm install
   npm run build
   ```

6. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å PM2:**
   ```bash
   pm2 start npm --name "1mb3-site" -- start
   pm2 save
   pm2 startup
   ```

7. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx –∫–∞–∫ reverse proxy:**
   ```bash
   sudo nano /etc/nginx/sites-available/1mb3
   ```

   –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
   ```nginx
   server {
       listen 80;
       server_name –≤–∞—à-–¥–æ–º–µ–Ω.ru;

       location / {
           proxy_pass http://localhost:3000;
           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection 'upgrade';
           proxy_set_header Host $host;
           proxy_cache_bypass $http_upgrade;
       }
   }
   ```

   –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
   ```bash
   sudo ln -s /etc/nginx/sites-available/1mb3 /etc/nginx/sites-enabled/
   sudo nginx -t
   sudo systemctl restart nginx
   ```

8. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt):**
   ```bash
   sudo apt install certbot python3-certbot-nginx
   sudo certbot --nginx -d –≤–∞—à-–¥–æ–º–µ–Ω.ru
   ```

---

## –í–∞—Ä–∏–∞–Ω—Ç 4: Railway

–ü—Ä–æ—Å—Ç–æ–π —Ö–æ—Å—Ç–∏–Ω–≥ —Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º —Ç–∞—Ä–∏—Ñ–æ–º.

### –®–∞–≥–∏:

1. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ Railway**
   - https://railway.app

2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç**
   - New Project ‚Üí Deploy from GitHub repo

3. **Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç Next.js
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   - –°–æ–±–µ—Ä–µ—Ç –ø—Ä–æ–µ–∫—Ç
   - –ó–∞–ø—É—Å—Ç–∏—Ç –Ω–∞ –ø–æ—Ä—Ç—É

4. **–ü–æ–ª—É—á–∏—Ç–µ URL**
   - Settings ‚Üí Generate Domain

---

## –í–∞—Ä–∏–∞–Ω—Ç 5: Docker (–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)

–î–ª—è –ª—é–±–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Docker.

### –°–æ–∑–¥–∞–π—Ç–µ `Dockerfile`:

```dockerfile
FROM node:20-alpine AS base

# Install dependencies only when needed
FROM base AS deps
RUN apk add --no-cache libc6-compat
WORKDIR /app

COPY package.json package-lock.json ./
RUN npm ci

# Rebuild the source code only when needed
FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .

RUN npm run build

# Production image
FROM base AS runner
WORKDIR /app

ENV NODE_ENV production

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs

EXPOSE 3000

ENV PORT 3000
ENV HOSTNAME "0.0.0.0"

CMD ["node", "server.js"]
```

### –°–æ–∑–¥–∞–π—Ç–µ `.dockerignore`:

```
node_modules
.next
.git
*.log
```

### –û–±–Ω–æ–≤–∏—Ç–µ `next.config.mjs`:

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'standalone',
};

export default nextConfig;
```

### –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker build -t 1mb3-site .
docker run -p 3000:3000 1mb3-site
```

---

## –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `lib/config.ts` - –≤—Å–µ URL –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –∞–∫—Ç—É–∞–ª—å–Ω—ã
- [ ] –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `NEXT_PUBLIC_SITE_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `paymentUrl` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ: `npm run build && npm start`
- [ ] –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.gitignore` - –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç–µ `.env` —Ñ–∞–π–ª—ã
- [ ] –ù–∞—Å—Ç—Ä–æ–π—Ç–µ analytics (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ)
- [ ] –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ–æ—Ä–º—ã –∏ –∫–Ω–æ–ø–∫–∏

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env.local` (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ Git!):

```env
NEXT_PUBLIC_SITE_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.ru
NEXT_PUBLIC_PAYMENT_URL=https://–≤–∞—à–∞-–ø–ª–∞—Ç–µ–∂–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞.ru
```

–ù–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞.

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### Vercel/Netlify:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–ø–ª–æ–∏ –ø—Ä–∏ push –≤ main
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ dashboard
- Rollback –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º

### VPS:
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
cd /var/www/–≤–∞—à-repo
git pull
npm install
npm run build
pm2 restart 1mb3-site

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
pm2 logs 1mb3-site

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–í–∫–ª—é—á–∏—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Nginx:**
   ```nginx
   location /_next/static {
       alias /var/www/–≤–∞—à-repo/.next/static;
       expires 365d;
       access_log off;
   }
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ CDN** (Cloudflare –±–µ—Å–ø–ª–∞—Ç–Ω–æ)

3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ WebP —Ñ–æ—Ä–º–∞—Ç
   - Next.js Image component —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç

4. **–í–∫–ª—é—á–∏—Ç–µ Gzip/Brotli —Å–∂–∞—Ç–∏–µ**

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `npm run build` –ª–æ–∫–∞–ª—å–Ω–æ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Node.js (–Ω—É–∂–Ω–∞ 18+)
4. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à: `rm -rf .next node_modules && npm install`

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Vercel (–≤–∞—Ä–∏–∞–Ω—Ç 1)
**–î–ª—è –†–§/–°–ù–ì —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º:** VPS (–≤–∞—Ä–∏–∞–Ω—Ç 3)
**–î–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:** Railway (–≤–∞—Ä–∏–∞–Ω—Ç 4)
