export type KnowledgeItem = {
  id: string;
  title: string;
  keywords: string[];
  answer: string;
};

export const knowledgeBase: KnowledgeItem[] = [
  {
    id: "what-is",
    title: "Что такое продукт 1MB3",
    keywords: ["что такое", "1mb3", "гайд", "продукт", "внутри"],
    answer:
      "1MB3 — это цифровой гайд 2026 (PDF + чек-листы + шаблоны) по монетизации ИИ в РФ/СНГ: 12 направлений, инструменты, план на 30 дней, юридические нюансы и примеры связок.",
  },
  {
    id: "who",
    title: "Кому подходит",
    keywords: ["кому", "подходит", "для кого", "новичок", "фриланс", "предприниматель"],
    answer:
      "Подходит новичкам, фрилансерам и предпринимателям, кто хочет структурно запустить заработок на ИИ через услуги или цифровые продукты.",
  },
  {
    id: "time",
    title: "Сколько времени нужно",
    keywords: ["сколько", "времени", "в день", "занимает"],
    answer:
      "В гайде есть план на 30 дней. Для старта обычно достаточно 30–90 минут в день на выполнение шагов.",
  },
  {
    id: "access",
    title: "Как получить доступ",
    keywords: ["доступ", "после оплаты", "где", "как получить", "когда"],
    answer:
      "Доступ к гайду выдаётся сразу после оплаты (по механике, указанной на странице оплаты: бот / email / кабинет). Если доступ не пришёл — напишите в поддержку.",
  },
  {
    id: "included",
    title: "Что входит",
    keywords: ["что входит", "что внутри", "состав", "модули", "получу"],
    answer:
      "Внутри: PDF-гайд 2026, 12 направлений, план на 30 дней, шаблон договора, чек-листы и бонус-каталог 200+ ИИ-сервисов.",
  },
  {
    id: "price",
    title: "Цена и ценность",
    keywords: ["цена", "стоимость", "сколько стоит", "дорого", "прайс"],
    answer:
      "Цена указана в блоке «Цена и доступ» на лендинге. Вы платите за структурированный практический гайд с готовыми сценариями, чтобы не терять время на хаотичный поиск информации.",
  },
  {
    id: "course-vs-guide",
    title: "Гайд или курс",
    keywords: ["курс", "обучение", "уроки", "куратор", "наставник", "созвон"],
    answer:
      "Это именно цифровой гайд (PDF + материалы), а не курс с уроками и не формат с куратором 1:1. Вы получаете готовую структуру и внедряете в удобном темпе.",
  },
  {
    id: "trust",
    title: "Доверие и ожидания",
    keywords: ["обман", "развод", "скам", "доверять", "реально", "гарантии"],
    answer:
      "Подход прозрачный: на странице чётко указано, что входит и что не входит в продукт. Гайд не обещает гарантированный доход — результат зависит от ваших действий и внедрения.",
  },
  {
    id: "not-included",
    title: "Что не входит",
    keywords: ["что не входит", "не входит", "куратор", "наставник", "гарантия дохода"],
    answer:
      "Не входит: личное наставничество, созвоны 1:1, выполнение работы за вас и гарантии конкретного дохода.",
  },
  {
    id: "refund",
    title: "Возврат и гарантии",
    keywords: ["возврат", "гарантия", "вернуть", "refund", "доход"],
    answer:
      "Гайд не даёт гарантии дохода. Условия возврата и использования описаны в оферте — обязательно ознакомьтесь перед оплатой.",
  },
];

export function findBestAnswer(query: string) {
  const q = query.toLowerCase();
  const scored = knowledgeBase
    .map((item) => {
      const hits = item.keywords.reduce((acc, k) => acc + (q.includes(k) ? 1 : 0), 0);
      return { item, hits };
    })
    .sort((a, b) => b.hits - a.hits);

  const best = scored[0];
  if (!best || best.hits === 0) return null;
  return best.item;
}
